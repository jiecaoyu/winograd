#!/usr/bin/env python2
from __future__ import absolute_import, division, print_function, unicode_literals
import numpy

# kernel_size = 5
G_4x4_5x5 = numpy.array([
    [    1.,      0.,     0.,      0.,      0.],
    [-2./9.,  -2./9., -2./9.,  -2./9.,  -2./9.],
    [-2./9.,   2./9., -2./9.,   2./9.,  -2./9.],
    [1./90.,  1./45., 2./45.,  4./45.,  8./45.],
    [1./90., -1./45., 2./45., -4./45.,  8./45.],
    [4./45.,  2./45., 1./45.,  1./90., 1./180.],
    [4./45., -2./45., 1./45., -1./90., 1./180.],
    [    0.,      0.,     0.,      0.,      1.]]
    )

BT_4x4_5x5 = numpy.array([
    [1.,   0.  ,  -21./4.,    0.  ,  21./4. ,    0. ,   -1.,  0.],
    [0. ,  1.   ,   1.    ,-17./4. , -17./4. ,   1.  ,  1.  , 0.],
    [0. ,  -1.  ,   1.    ,17./4.  , -17./4. ,  -1.  ,  1.  , 0.],
    [0. , 1./2. ,   1./4. ,  -5./2.,   -5./4.,     2.,    1.,   0.],
    [0. , -1./2.,   1./4. ,   5./2.,   -5./4.,    -2.,    1.,   0.],
    [0. ,  2.   ,   4.    ,-5./2.  ,  -5.    , 1./2. ,  1.  , 0.],
    [0. ,  -2.  ,   4.    , 5./2.  ,  -5.    ,-1./2. ,  1.  , 0.],
    [0. ,  -1.  ,   0.    ,21./4.  ,   0.    ,-21./4.,  0.  , 1.]]
    )

AT_4x4_5x5 = numpy.array([
    [1.,  1. , 1. ,  1.,  1. ,  8. , 8. ,  0.],
    [0.,  1. , -1.,  2.,  -2.,  4. , -4.,  0.],
    [0.,  1. , 1. ,  4.,  4. ,  2. , 2. ,  0.],
    [0.,  1. , -1.,  8.,  -8.,  1. , -1.,  1.]]
    )


S_4x4_5x5 = numpy.array([
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [-2/9, -2/9, -2/9, -2/9, -2/9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [-2/9, 2/9, -2/9, 2/9, -2/9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [1/90, 1/45, 2/45, 4/45, 8/45, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [1/90, -1/45, 2/45, -4/45, 8/45, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [4/45, 2/45, 1/45, 1/90, 1/180, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [4/45, -2/45, 1/45, -1/90, 1/180, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [-2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0],
    [4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81, 4/81],
    [4/81, -4/81, 4/81, -4/81, 4/81, 4/81, -4/81, 4/81, -4/81, 4/81, 4/81, -4/81, 4/81, -4/81, 4/81, 4/81, -4/81, 4/81, -4/81, 4/81, 4/81, -4/81, 4/81, -4/81, 4/81],
    [-1/405, -2/405, -4/405, -8/405, -16/405, -1/405, -2/405, -4/405, -8/405, -16/405, -1/405, -2/405, -4/405, -8/405, -16/405, -1/405, -2/405, -4/405, -8/405, -16/405, -1/405, -2/405, -4/405, -8/405, -16/405],
    [-1/405, 2/405, -4/405, 8/405, -16/405, -1/405, 2/405, -4/405, 8/405, -16/405, -1/405, 2/405, -4/405, 8/405, -16/405, -1/405, 2/405, -4/405, 8/405, -16/405, -1/405, 2/405, -4/405, 8/405, -16/405],
    [-8/405, -4/405, -2/405, -1/405, -1/810, -8/405, -4/405, -2/405, -1/405, -1/810, -8/405, -4/405, -2/405, -1/405, -1/810, -8/405, -4/405, -2/405, -1/405, -1/810, -8/405, -4/405, -2/405, -1/405, -1/810],
    [-8/405, 4/405, -2/405, 1/405, -1/810, -8/405, 4/405, -2/405, 1/405, -1/810, -8/405, 4/405, -2/405, 1/405, -1/810, -8/405, 4/405, -2/405, 1/405, -1/810, -8/405, 4/405, -2/405, 1/405, -1/810],
    [0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, -2/9],
    [-2/9, 0, 0, 0, 0, 2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, 2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0],
    [4/81, 4/81, 4/81, 4/81, 4/81, -4/81, -4/81, -4/81, -4/81, -4/81, 4/81, 4/81, 4/81, 4/81, 4/81, -4/81, -4/81, -4/81, -4/81, -4/81, 4/81, 4/81, 4/81, 4/81, 4/81],
    [4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81, -4/81, 4/81],
    [-1/405, -2/405, -4/405, -8/405, -16/405, 1/405, 2/405, 4/405, 8/405, 16/405, -1/405, -2/405, -4/405, -8/405, -16/405, 1/405, 2/405, 4/405, 8/405, 16/405, -1/405, -2/405, -4/405, -8/405, -16/405],
    [-1/405, 2/405, -4/405, 8/405, -16/405, 1/405, -2/405, 4/405, -8/405, 16/405, -1/405, 2/405, -4/405, 8/405, -16/405, 1/405, -2/405, 4/405, -8/405, 16/405, -1/405, 2/405, -4/405, 8/405, -16/405],
    [-8/405, -4/405, -2/405, -1/405, -1/810, 8/405, 4/405, 2/405, 1/405, 1/810, -8/405, -4/405, -2/405, -1/405, -1/810, 8/405, 4/405, 2/405, 1/405, 1/810, -8/405, -4/405, -2/405, -1/405, -1/810],
    [-8/405, 4/405, -2/405, 1/405, -1/810, 8/405, -4/405, 2/405, -1/405, 1/810, -8/405, 4/405, -2/405, 1/405, -1/810, 8/405, -4/405, 2/405, -1/405, 1/810, -8/405, 4/405, -2/405, 1/405, -1/810],
    [0, 0, 0, 0, -2/9, 0, 0, 0, 0, 2/9, 0, 0, 0, 0, -2/9, 0, 0, 0, 0, 2/9, 0, 0, 0, 0, -2/9],
    [1/90, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, 4/45, 0, 0, 0, 0, 8/45, 0, 0, 0, 0],
    [-1/405, -1/405, -1/405, -1/405, -1/405, -2/405, -2/405, -2/405, -2/405, -2/405, -4/405, -4/405, -4/405, -4/405, -4/405, -8/405, -8/405, -8/405, -8/405, -8/405, -16/405, -16/405, -16/405, -16/405, -16/405],
    [-1/405, 1/405, -1/405, 1/405, -1/405, -2/405, 2/405, -2/405, 2/405, -2/405, -4/405, 4/405, -4/405, 4/405, -4/405, -8/405, 8/405, -8/405, 8/405, -8/405, -16/405, 16/405, -16/405, 16/405, -16/405],
    [1/8100, 1/4050, 1/2025, 2/2025, 4/2025, 1/4050, 1/2025, 2/2025, 4/2025, 8/2025, 1/2025, 2/2025, 4/2025, 8/2025, 16/2025, 2/2025, 4/2025, 8/2025, 16/2025, 32/2025, 4/2025, 8/2025, 16/2025, 32/2025, 64/2025],
    [1/8100, -1/4050, 1/2025, -2/2025, 4/2025, 1/4050, -1/2025, 2/2025, -4/2025, 8/2025, 1/2025, -2/2025, 4/2025, -8/2025, 16/2025, 2/2025, -4/2025, 8/2025, -16/2025, 32/2025, 4/2025, -8/2025, 16/2025, -32/2025, 64/2025],
    [2/2025, 1/2025, 1/4050, 1/8100, 1/16200, 4/2025, 2/2025, 1/2025, 1/4050, 1/8100, 8/2025, 4/2025, 2/2025, 1/2025, 1/4050, 16/2025, 8/2025, 4/2025, 2/2025, 1/2025, 32/2025, 16/2025, 8/2025, 4/2025, 2/2025],
    [2/2025, -1/2025, 1/4050, -1/8100, 1/16200, 4/2025, -2/2025, 1/2025, -1/4050, 1/8100, 8/2025, -4/2025, 2/2025, -1/2025, 1/4050, 16/2025, -8/2025, 4/2025, -2/2025, 1/2025, 32/2025, -16/2025, 8/2025, -4/2025, 2/2025],
    [0, 0, 0, 0, 1/90, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, 4/45, 0, 0, 0, 0, 8/45],
    [1/90, 0, 0, 0, 0, -1/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, -4/45, 0, 0, 0, 0, 8/45, 0, 0, 0, 0],
    [-1/405, -1/405, -1/405, -1/405, -1/405, 2/405, 2/405, 2/405, 2/405, 2/405, -4/405, -4/405, -4/405, -4/405, -4/405, 8/405, 8/405, 8/405, 8/405, 8/405, -16/405, -16/405, -16/405, -16/405, -16/405],
    [-1/405, 1/405, -1/405, 1/405, -1/405, 2/405, -2/405, 2/405, -2/405, 2/405, -4/405, 4/405, -4/405, 4/405, -4/405, 8/405, -8/405, 8/405, -8/405, 8/405, -16/405, 16/405, -16/405, 16/405, -16/405],
    [1/8100, 1/4050, 1/2025, 2/2025, 4/2025, -1/4050, -1/2025, -2/2025, -4/2025, -8/2025, 1/2025, 2/2025, 4/2025, 8/2025, 16/2025, -2/2025, -4/2025, -8/2025, -16/2025, -32/2025, 4/2025, 8/2025, 16/2025, 32/2025, 64/2025],
    [1/8100, -1/4050, 1/2025, -2/2025, 4/2025, -1/4050, 1/2025, -2/2025, 4/2025, -8/2025, 1/2025, -2/2025, 4/2025, -8/2025, 16/2025, -2/2025, 4/2025, -8/2025, 16/2025, -32/2025, 4/2025, -8/2025, 16/2025, -32/2025, 64/2025],
    [2/2025, 1/2025, 1/4050, 1/8100, 1/16200, -4/2025, -2/2025, -1/2025, -1/4050, -1/8100, 8/2025, 4/2025, 2/2025, 1/2025, 1/4050, -16/2025, -8/2025, -4/2025, -2/2025, -1/2025, 32/2025, 16/2025, 8/2025, 4/2025, 2/2025],
    [2/2025, -1/2025, 1/4050, -1/8100, 1/16200, -4/2025, 2/2025, -1/2025, 1/4050, -1/8100, 8/2025, -4/2025, 2/2025, -1/2025, 1/4050, -16/2025, 8/2025, -4/2025, 2/2025, -1/2025, 32/2025, -16/2025, 8/2025, -4/2025, 2/2025],
    [0, 0, 0, 0, 1/90, 0, 0, 0, 0, -1/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, -4/45, 0, 0, 0, 0, 8/45],
    [4/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, 1/90, 0, 0, 0, 0, 1/180, 0, 0, 0, 0],
    [-8/405, -8/405, -8/405, -8/405, -8/405, -4/405, -4/405, -4/405, -4/405, -4/405, -2/405, -2/405, -2/405, -2/405, -2/405, -1/405, -1/405, -1/405, -1/405, -1/405, -1/810, -1/810, -1/810, -1/810, -1/810],
    [-8/405, 8/405, -8/405, 8/405, -8/405, -4/405, 4/405, -4/405, 4/405, -4/405, -2/405, 2/405, -2/405, 2/405, -2/405, -1/405, 1/405, -1/405, 1/405, -1/405, -1/810, 1/810, -1/810, 1/810, -1/810],
    [2/2025, 4/2025, 8/2025, 16/2025, 32/2025, 1/2025, 2/2025, 4/2025, 8/2025, 16/2025, 1/4050, 1/2025, 2/2025, 4/2025, 8/2025, 1/8100, 1/4050, 1/2025, 2/2025, 4/2025, 1/16200, 1/8100, 1/4050, 1/2025, 2/2025],
    [2/2025, -4/2025, 8/2025, -16/2025, 32/2025, 1/2025, -2/2025, 4/2025, -8/2025, 16/2025, 1/4050, -1/2025, 2/2025, -4/2025, 8/2025, 1/8100, -1/4050, 1/2025, -2/2025, 4/2025, 1/16200, -1/8100, 1/4050, -1/2025, 2/2025],
    [16/2025, 8/2025, 4/2025, 2/2025, 1/2025, 8/2025, 4/2025, 2/2025, 1/2025, 1/4050, 4/2025, 2/2025, 1/2025, 1/4050, 1/8100, 2/2025, 1/2025, 1/4050, 1/8100, 1/16200, 1/2025, 1/4050, 1/8100, 1/16200, 1/32400],
    [16/2025, -8/2025, 4/2025, -2/2025, 1/2025, 8/2025, -4/2025, 2/2025, -1/2025, 1/4050, 4/2025, -2/2025, 1/2025, -1/4050, 1/8100, 2/2025, -1/2025, 1/4050, -1/8100, 1/16200, 1/2025, -1/4050, 1/8100, -1/16200, 1/32400],
    [0, 0, 0, 0, 4/45, 0, 0, 0, 0, 2/45, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, 1/90, 0, 0, 0, 0, 1/180],
    [4/45, 0, 0, 0, 0, -2/45, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, -1/90, 0, 0, 0, 0, 1/180, 0, 0, 0, 0],
    [-8/405, -8/405, -8/405, -8/405, -8/405, 4/405, 4/405, 4/405, 4/405, 4/405, -2/405, -2/405, -2/405, -2/405, -2/405, 1/405, 1/405, 1/405, 1/405, 1/405, -1/810, -1/810, -1/810, -1/810, -1/810],
    [-8/405, 8/405, -8/405, 8/405, -8/405, 4/405, -4/405, 4/405, -4/405, 4/405, -2/405, 2/405, -2/405, 2/405, -2/405, 1/405, -1/405, 1/405, -1/405, 1/405, -1/810, 1/810, -1/810, 1/810, -1/810],
    [2/2025, 4/2025, 8/2025, 16/2025, 32/2025, -1/2025, -2/2025, -4/2025, -8/2025, -16/2025, 1/4050, 1/2025, 2/2025, 4/2025, 8/2025, -1/8100, -1/4050, -1/2025, -2/2025, -4/2025, 1/16200, 1/8100, 1/4050, 1/2025, 2/2025],
    [2/2025, -4/2025, 8/2025, -16/2025, 32/2025, -1/2025, 2/2025, -4/2025, 8/2025, -16/2025, 1/4050, -1/2025, 2/2025, -4/2025, 8/2025, -1/8100, 1/4050, -1/2025, 2/2025, -4/2025, 1/16200, -1/8100, 1/4050, -1/2025, 2/2025],
    [16/2025, 8/2025, 4/2025, 2/2025, 1/2025, -8/2025, -4/2025, -2/2025, -1/2025, -1/4050, 4/2025, 2/2025, 1/2025, 1/4050, 1/8100, -2/2025, -1/2025, -1/4050, -1/8100, -1/16200, 1/2025, 1/4050, 1/8100, 1/16200, 1/32400],
    [16/2025, -8/2025, 4/2025, -2/2025, 1/2025, -8/2025, 4/2025, -2/2025, 1/2025, -1/4050, 4/2025, -2/2025, 1/2025, -1/4050, 1/8100, -2/2025, 1/2025, -1/4050, 1/8100, -1/16200, 1/2025, -1/4050, 1/8100, -1/16200, 1/32400],
    [0, 0, 0, 0, 4/45, 0, 0, 0, 0, -2/45, 0, 0, 0, 0, 1/45, 0, 0, 0, 0, -1/90, 0, 0, 0, 0, 1/180],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2/9, -2/9, -2/9, -2/9, -2/9],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2/9, 2/9, -2/9, 2/9, -2/9],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/90, 1/45, 2/45, 4/45, 8/45],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1/90, -1/45, 2/45, -4/45, 8/45],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4/45, 2/45, 1/45, 1/90, 1/180],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4/45, -2/45, 1/45, -1/90, 1/180],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
    ])

# kernel_size = 3
G_4x4_3x3 = numpy.array([
    [ 1./4.,      0.,     0.],
    [-1./6.,  -1./6., -1./6.],
    [-1./6.,   1./6., -1./6.],
    [1./24.,  1./12.,  1./6.],
    [1./24., -1./12.,  1./6.],
    [    0.,      0.,    1.]]
    )

BT_4x4_3x3 = numpy.array([
    [4.,  0., -5.,  0., 1., 0.],
    [0., -4., -4.,  1., 1., 0.],
    [0.,  4., -4., -1., 1., 0.],
    [0., -2., -1.,  2., 1., 0.],
    [0.,  2., -1., -2., 1., 0.],
    [0.,  4.,  0., -5., 0., 1.]]
    )

AT_4x4_3x3 = numpy.array([
    [1., 1.,  1., 1.,  1., 0.],
    [0., 1., -1., 2., -2., 0.],
    [0., 1.,  1., 4.,  4., 0.],
    [0., 1., -1., 8., -8., 1.]]
    )


mask_multi_4x4_3x3 = numpy.array([
    [ 33.2565783 ,   48.74423043,  53.44155686, 133.60389216, 133.60389216, 29.15475947],
    [ 48.74423043,   65.96969001,  96.16652224, 240.4163056 , 240.4163056 ,48.74423043],
    [ 53.44155686,   96.16652224,  96.16652224, 240.4163056 , 240.4163056 ,53.44155686],
    [133.60389216,  240.4163056 , 240.4163056 , 601.04076401, 601.04076401, 133.60389216],
    [133.60389216,  240.4163056 , 240.4163056 , 601.04076401, 601.04076401, 133.60389216],
    [ 29.15475947,   48.74423043,  53.44155686, 133.60389216, 133.60389216, 29.15475947]])

mask_multi_4x4_5x5 = numpy.array([
    [  40.40585122,   67.72947106,   67.70732051,  178.50781233,  178.50781233, 357.01562466 , 357.01562466 ,  40.39347488],
    [  67.72947106,   68.0661443 ,  113.49063838,  275.45558853,  290.88448094, 550.91117705 , 581.76896187 ,  67.70732051],
    [  67.70732051,  113.49063838,  113.49063838,  299.2138136 ,  299.2138136 ,598.4276272   ,598.4276272   , 67.70732051],
    [ 178.50781233,  275.45558853,  299.2138136 ,  774.42329853,  783.69729189, 1548.84659707, 1567.39458378,  178.50781233],
    [ 178.50781233,  290.88448094,  299.2138136 ,  783.69729189,  787.0091774 ,1567.39458378 ,1574.0183548  , 178.50781233],
    [ 357.01562466,  550.91117705,  598.4276272 , 1548.84659707, 1567.39458378, 3097.69319414, 3134.78916755,  357.01562466],
    [ 357.01562466,  581.76896187,  598.4276272 , 1567.39458378, 1574.0183548 ,3134.78916755 ,3148.0367096  , 357.01562466],
    [  40.39347488,   67.70732051,   67.70732051,  178.50781233,  178.50781233, 357.01562466 , 357.01562466 ,  40.39347488]
    ])
